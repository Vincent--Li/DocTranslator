import{_ as F,D as H,G as W,e as M,y as o,o as y,c as w,a as n,t as C,h as x,A as L,i as f,j as T,H as X,k as A,w as t,I as Z,r as k,g as e,J as ee,d as K,f as N,F as q,K as te,L as le,M as ae,E as h,N as oe,m as ne,O as se,P as re,u as ie,Q as E,R as J,S as G,l as Y,T as j}from"./index-B58uIFBw.js";import{F as ue}from"./filing-bcaPAROW.js";function Q(S){const r=new Date(S),v=r.getFullYear(),l=(r.getMonth()+1).toString().padStart(2,"0"),d=r.getDate().toString().padStart(2,"0"),s=r.getHours().toString().padStart(2,"0"),g=r.getMinutes().toString().padStart(2,"0"),a=r.getSeconds().toString().padStart(2,"0");return`${v}-${l}-${d} ${s}:${g}:${a}`}const de={class:"basic-info"},pe={class:"info-row"},ce={class:"info-content"},_e={class:"info-row"},me={class:"info-content"},fe={key:0,src:Z,class:"vip-icon"},ve={class:"info-row"},ge={class:"info-content"},be={class:"info-row"},ye={class:"storage-display"},ke={class:"storage-bar"},xe={class:"storage-details"},Se={class:"storage-text"},Ie={class:"storage-percent"},Ve=104857600,we={__name:"BasicInfo",props:{userInfo:{type:Object,required:!0,default:()=>({email:"",level:"",storage:0,create_at:""})}},setup(S){const r=H(),v=S,{userInfo:l}=W(v),d=M(()=>{const a=l.value.storage/Ve*100;return Math.min(100,parseFloat(a.toFixed(2)))}),s=M(()=>43.76963138580322.toFixed(2)+" MB"),g=()=>{r.push("/upgrade")};return(a,p)=>{const I=o("el-button");return y(),w("div",de,[n("div",pe,[p[0]||(p[0]=n("span",{class:"info-label"},"邮箱账号：",-1)),n("span",ce,C(x(l).email||"-"),1)]),n("div",_e,[p[1]||(p[1]=n("span",{class:"info-label"},"账户类型：",-1)),n("span",me,[n("span",{class:L(["user-level",{vip:x(l).level==="vip"}])},[f(C(x(l).level==="vip"?"VIP会员":"普通用户")+" ",1),x(l).level==="vip"?(y(),w("img",fe)):T("",!0)],2)])]),n("div",ve,[p[2]||(p[2]=n("span",{class:"info-label"},"注册时间：",-1)),n("span",ge,C(x(Q)(x(l).created_at)||"-"),1)]),n("div",be,[p[4]||(p[4]=n("span",{class:"info-label"},"存储空间：",-1)),n("div",ye,[n("div",ke,[n("div",{class:L(["storage-used",{warning:d.value>80}]),style:X({width:d.value+"%"})},null,6)]),n("div",xe,[n("span",Se,C(s.value)+" / 100 MB ",1),n("span",Ie,C(d.value)+"%",1),x(l).level!=="vip"?(y(),A(I,{key:0,type:"text",size:"small",class:"upgrade-btn",onClick:g},{default:t(()=>p[3]||(p[3]=[f(" 扩容空间 ")])),_:1})):T("",!0)])])])])}}},$e=F(we,[["__scopeId","data-v-2bcb0516"]]),Ce={class:"security-settings"},De={class:"email-display"},he={class:"security-tips"},Ae={class:"code-input"},Fe={__name:"SecuritySettings",props:{email:{type:String,required:!0}},setup(S){const r=k(!1),v=k({email:"",code:""}),l=k(0),d=()=>{l.value=60;const g=setInterval(()=>{l.value--,l.value<=0&&clearInterval(g)},1e3)},s=()=>{emit("bind-email",v.value.email),r.value=!1};return(g,a)=>{const p=o("el-button"),I=o("el-form-item"),u=o("el-icon"),m=o("el-form"),i=o("el-input"),c=o("el-dialog");return y(),w("div",Ce,[e(m,{"label-width":"120px"},{default:t(()=>[e(I,{label:"登录邮箱"},{default:t(()=>[n("div",De,[f(C(S.email)+" ",1),e(p,{type:"text"},{default:t(()=>a[5]||(a[5]=[f("更换邮箱")])),_:1})])]),_:1}),e(I,{label:"登录密码"},{default:t(()=>[e(p,{onClick:a[0]||(a[0]=b=>g.$router.push("/reset"))},{default:t(()=>a[6]||(a[6]=[f("修改密码")])),_:1})]),_:1}),e(I,{label:"账号安全"},{default:t(()=>[n("div",he,[e(u,null,{default:t(()=>[e(x(ee))]),_:1}),a[7]||(a[7]=n("span",null,"请妥善保管您的账号信息，不要泄露给他人",-1))])]),_:1})]),_:1}),e(c,{modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=b=>r.value=b),title:"绑定新邮箱",width:"400px"},{footer:t(()=>[e(p,{onClick:a[3]||(a[3]=b=>r.value=!1)},{default:t(()=>a[8]||(a[8]=[f("取消")])),_:1}),e(p,{type:"primary",onClick:s},{default:t(()=>a[9]||(a[9]=[f("确认绑定")])),_:1})]),default:t(()=>[e(m,{model:v.value,"label-width":"80px"},{default:t(()=>[e(I,{label:"新邮箱",prop:"email"},{default:t(()=>[e(i,{modelValue:v.value.email,"onUpdate:modelValue":a[1]||(a[1]=b=>v.value.email=b),placeholder:"请输入新邮箱地址"},null,8,["modelValue"])]),_:1}),e(I,{label:"验证码",prop:"code"},{default:t(()=>[n("div",Ae,[e(i,{modelValue:v.value.code,"onUpdate:modelValue":a[2]||(a[2]=b=>v.value.code=b),placeholder:"请输入验证码"},null,8,["modelValue"]),e(p,{type:"primary",disabled:l.value>0,onClick:d},{default:t(()=>[f(C(l.value>0?`${l.value}秒后重试`:"获取验证码"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ue=F(Fe,[["__scopeId","data-v-708633d7"]]),Te={class:"label-with-ad"},Pe={class:"form-actions"},Be={__name:"AiTranslationSettings",setup(S){const r=K(),v=k(null),l=k({provider:"openai",api_url:"",api_key:""}),d=M(()=>K().isVIP),s=k(!1),g=k(!1),a=k(""),p=M(()=>a.value==="success"?"success":a.value==="fail"?"danger":""),I=()=>{window.open("https://api.ezworkapi.top","_blank")},u={provider:[{required:!0,message:"请选择服务商",trigger:"change"}],api_url:[{required:!0,message:"请输入API地址",trigger:"blur"}],api_key:[{required:!0,message:"请输入API Key",trigger:"blur"}]},m=M(()=>l.provider==="openai"&&l.api_url&&l.api_key),i=async()=>{if(m.value)try{g.value=!0,a.value="";const b=await ae({api_url:l.api_url,api_key:l.api_key});a.value=b.code===200?"success":"fail"}catch{a.value="fail"}finally{g.value=!1}},c=async()=>{try{await v.value.validate(),s.value=!0,r.updateAIServerSettings({api_url:l.value.api_url,api_key:l.value.api_key}),h.success("保存成功!")}catch(b){console.error("表单验证失败:",b)}finally{s.value=!1}};return N(()=>{l.value={provider:"openai",api_url:r.aiServer.api_url,api_key:r.aiServer.api_key}}),(b,_)=>{const $=o("el-radio-button"),P=o("el-radio-group"),D=o("el-form-item"),O=o("el-tag"),R=o("el-input"),U=o("el-button"),z=o("el-icon"),V=o("el-form");return y(),A(V,{ref_key:"formRef",ref:v,model:l.value,rules:u,"label-width":"120px","label-position":"top"},{default:t(()=>[e(D,{label:"服务商",prop:"provider"},{default:t(()=>[e(P,{modelValue:l.value.provider,"onUpdate:modelValue":_[0]||(_[0]=B=>l.value.provider=B)},{default:t(()=>[e($,{label:"openai"},{default:t(()=>_[3]||(_[3]=[f("OpenAI")])),_:1}),e($,{label:"member",disabled:!d.value},{default:t(()=>_[4]||(_[4]=[f("DocTranslator 会员")])),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l.value.provider==="openai"?(y(),w(q,{key:0},[e(D,{prop:"api_url"},{label:t(()=>[n("span",Te,[_[6]||(_[6]=f(" API地址 ")),e(O,{size:"mini",type:"warning",style:{"margin-left":"8px",cursor:"pointer","font-size":"medium"},onClick:I},{default:t(()=>_[5]||(_[5]=[f(" 🔥 推荐使用在线api中转站 ")])),_:1})])]),default:t(()=>[e(R,{modelValue:l.value.api_url,"onUpdate:modelValue":_[1]||(_[1]=B=>l.value.api_url=B),placeholder:"https://api.ezworkapi.top",clearable:""},null,8,["modelValue"])]),_:1}),e(D,{label:"API密钥",prop:"api_key"},{default:t(()=>[e(R,{modelValue:l.value.api_key,"onUpdate:modelValue":_[2]||(_[2]=B=>l.value.api_key=B),placeholder:"输入您的API Key","show-password":"",clearable:""},null,8,["modelValue"])]),_:1})],64)):T("",!0),e(D,null,{default:t(()=>[n("div",Pe,[e(U,{type:"primary",onClick:c,loading:s.value},{default:t(()=>_[7]||(_[7]=[f(" 保存设置 ")])),_:1},8,["loading"]),e(U,{type:p.value,onClick:i,loading:g.value,disabled:!m.value},{default:t(()=>[a.value==="success"?(y(),w(q,{key:0},[e(z,{class:"success-icon"},{default:t(()=>[e(x(te))]),_:1}),_[8]||(_[8]=f(" 连接正常 "))],64)):a.value==="fail"?(y(),w(q,{key:1},[e(z,{class:"error-icon"},{default:t(()=>[e(x(le))]),_:1}),_[9]||(_[9]=f(" 连接失败 "))],64)):(y(),w(q,{key:2},[f(" 检查连接 ")],64))]),_:1},8,["type","loading","disabled"])])]),_:1})]),_:1},8,["model"])}}},qe=F(Be,[["__scopeId","data-v-b837f7e2"]]),Me={__name:"MachineTranslationSettings",setup(S){const r=K(),v=k(null),l=k({});N(()=>{l.value={provider:"baidu",app_id:r.baidu.app_id,app_key:r.baidu.app_key}});const d={provider:[{required:!0,message:"请选择翻译引擎",trigger:"change"}],app_id:[{required:!0,message:"请输入App ID",trigger:"blur"}],app_key:[{required:!0,message:"请输入App Key",trigger:"blur"}]},s=async()=>{try{await v.value.validate(),r.updateBaiduSettings({app_id:l.value.app_id,app_key:l.value.app_key}),h.success("保存成功!")}catch(g){console.error("表单验证失败:",g)}};return(g,a)=>{const p=o("el-option"),I=o("el-select"),u=o("el-form-item"),m=o("el-input"),i=o("el-button"),c=o("el-form");return y(),A(c,{ref_key:"formRef",ref:v,model:l.value,rules:d,"label-width":"120px","label-position":"top"},{default:t(()=>[e(u,{label:"翻译引擎",prop:"provider"},{default:t(()=>[e(I,{modelValue:l.value.provider,"onUpdate:modelValue":a[0]||(a[0]=b=>l.value.provider=b),placeholder:"选择翻译引擎"},{default:t(()=>[e(p,{label:"百度翻译",value:"baidu"}),e(p,{label:"有道翻译",value:"youdao"}),e(p,{label:"Google翻译",value:"google"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"App ID",prop:"app_id"},{default:t(()=>[e(m,{modelValue:l.value.app_id,"onUpdate:modelValue":a[1]||(a[1]=b=>l.value.app_id=b),placeholder:"输入应用ID",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"App Key",prop:"app_key"},{default:t(()=>[e(m,{modelValue:l.value.app_key,"onUpdate:modelValue":a[2]||(a[2]=b=>l.value.app_key=b),placeholder:"输入应用密钥","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(i,{type:"primary",onClick:s},{default:t(()=>a[3]||(a[3]=[f("保存设置")])),_:1})]),_:1})]),_:1},8,["model"])}}},Ne={__name:"CommonSettings",setup(S){const r=K(),v=k(null),l=k([]),d=k(!1),s=k({});N(()=>{s.value={comparison_id:r.aiServer.comparison_id,type:r.common.type,threads:r.common.threads,doc2x_flag:r.common.doc2x_flag,doc2x_secret_key:r.common.doc2x_secret_key}});const g=oe({comparison_id:[{required:!1}],type:[{required:!0,message:"请选择译文形式",trigger:"change"}],threads:[{required:!0,message:"请设置线程数",trigger:"blur"},{type:"number",min:1,max:20,message:"线程数必须在1-20之间",trigger:"blur"}],doc2x_secret_key:[{required:s.doc2x_flag==="Y",message:"请输入Doc2x API Key",trigger:"blur"}]}),a=async()=>{try{const i=await se();i.code===200&&(l.value=i.data.data)}catch(i){console.error("获取术语列表失败:",i),h.error("获取术语列表失败")}},p=i=>{i==="N"&&(s.doc2x_secret_key=""),g.doc2x_secret_key[0].required=i==="Y"},I=async()=>{if(!s.doc2x_secret_key){h.warning("请先输入Doc2x API Key");return}try{d.value=!0;const i=await re({doc2x_secret_key:s.doc2x_secret_key});i.code===0?h.success("Doc2x连接测试成功"):h.error(i.message||"Doc2x连接测试失败")}catch(i){console.error("Doc2x连接测试异常:",i),h.error("连接测试异常，请检查网络或服务状态")}finally{d.value=!1}},u=async()=>{try{await v.value.validate();const i={threads:s.value.threads,doc2x_flag:s.value.doc2x_flag,doc2x_secret_key:s.value.doc2x_secret_key};r.updateCommonSettings(i),r.updateAIServerSettings({comparison_id:s.value.comparison_id}),h.success("保存成功!")}catch(i){console.error("表单验证失败:",i),h.error("请检查表单填写是否正确")}},m=()=>{var i;(i=v.value)==null||i.resetFields(),Object.assign(s,props.settings)};return N(()=>{a()}),(i,c)=>{const b=o("el-option"),_=o("el-select"),$=o("el-form-item"),P=o("el-input-number"),D=o("el-radio"),O=o("el-radio-group"),R=o("el-input"),U=o("el-button"),z=o("el-form");return y(),A(z,{ref_key:"formRef",ref:v,model:s.value,rules:g,"label-width":"120px","label-position":"top"},{default:t(()=>[e($,{label:"默认术语库(AI翻译):",prop:"comparison_id"},{default:t(()=>[e(_,{modelValue:s.value.comparison_id,"onUpdate:modelValue":c[0]||(c[0]=V=>s.value.comparison_id=V),placeholder:"选择术语库",clearable:"",filterable:"",style:{width:"100%"},onFocus:a},{default:t(()=>[(y(!0),w(q,null,ne(l.value,V=>(y(),A(b,{key:V.id,label:V.title,value:V.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e($,{label:"线程数:",prop:"threads"},{default:t(()=>[e(P,{modelValue:s.value.threads,"onUpdate:modelValue":c[1]||(c[1]=V=>s.value.threads=V),min:1,max:20,step:1},null,8,["modelValue"])]),_:1}),e($,{label:"是否使用Doc2x翻译PDF文件:"},{default:t(()=>[e(O,{modelValue:s.value.doc2x_flag,"onUpdate:modelValue":c[2]||(c[2]=V=>s.value.doc2x_flag=V),onChange:p},{default:t(()=>[e(D,{label:"N"},{default:t(()=>c[4]||(c[4]=[f("禁用")])),_:1}),e(D,{label:"Y"},{default:t(()=>c[5]||(c[5]=[f("启用")])),_:1})]),_:1},8,["modelValue"])]),_:1}),s.value.doc2x_flag==="Y"?(y(),A($,{key:0,label:"Doc2x密钥",prop:"doc2x_secret_key"},{default:t(()=>[e(R,{modelValue:s.value.doc2x_secret_key,"onUpdate:modelValue":c[3]||(c[3]=V=>s.value.doc2x_secret_key=V),placeholder:"输入Doc2x API Key",clearable:"",style:{width:"300px","margin-right":"10px"}},null,8,["modelValue"]),e(U,{type:"primary",plain:"",loading:d.value,onClick:I},{default:t(()=>c[6]||(c[6]=[f(" 测试连接 ")])),_:1},8,["loading"])]),_:1})):T("",!0),e($,null,{default:t(()=>[e(U,{type:"primary",onClick:u},{default:t(()=>c[7]||(c[7]=[f("保存设置")])),_:1}),e(U,{onClick:m},{default:t(()=>c[8]||(c[8]=[f("重置")])),_:1})]),_:1})]),_:1},8,["model","rules"])}}},Re=F(Ne,[["__scopeId","data-v-bc6c7598"]]),ze={class:"translation-settings-container"},Ke={__name:"TranslationSettings",setup(S){const r=k("ai");return(v,l)=>{const d=o("el-tab-pane"),s=o("el-tabs");return y(),w("div",ze,[e(s,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=g=>r.value=g),class:"settings-tabs"},{default:t(()=>[e(d,{label:"AI翻译",name:"ai"},{default:t(()=>[e(qe,{ref:"aiSettingsForm"},null,512)]),_:1}),e(d,{label:"机器翻译",name:"machine"},{default:t(()=>[e(Me,{ref:"machineSettingsForm"},null,512)]),_:1}),e(d,{label:"通用设置",name:"common"},{default:t(()=>[e(Re,{ref:"commonSettingsForm"},null,512)]),_:1})]),_:1},8,["modelValue"])])}}},Oe=F(Ke,[["__scopeId","data-v-ebb20e3f"]]),Ye={class:"profile-content"},je={class:"user-details"},Le={class:"name-row"},Ee={class:"username"},Je={key:0,class:"vip-badge"},Ge={class:"meta-row"},He={class:"meta-item"},Qe={class:"meta-item"},We={__name:"UserCard",props:{userInfo:{type:Object,required:!0,default:()=>({email:"",level:"",storage:0,create_at:""})}},setup(S){return(r,v)=>{const l=o("el-avatar"),d=o("StarFilled"),s=o("el-icon"),g=o("Message"),a=o("Calendar"),p=o("el-card");return y(),A(p,{class:"user-profile-card"},{default:t(()=>[n("div",Ye,[e(l,{size:64,src:S.userInfo.avatar||r.defaultAvatar},null,8,["src"]),n("div",je,[n("div",Le,[n("span",Ee,C(S.userInfo.username),1),S.userInfo.level==="vip"?(y(),w("span",Je,[e(s,null,{default:t(()=>[e(d)]),_:1})])):T("",!0)]),n("div",Ge,[n("div",He,[e(s,null,{default:t(()=>[e(g)]),_:1}),n("span",null,C(S.userInfo.email),1)]),n("div",Qe,[e(s,null,{default:t(()=>[e(a)]),_:1}),n("span",null,C(x(Q)(S.userInfo.created_at)||"未设置"),1)])])])])]),_:1})}}},Xe=F(We,[["__scopeId","data-v-657388d7"]]),Ze={class:"personal-center-container"},et={class:"scrollable-content-area"},tt={class:"main-content-wrapper"},lt={class:"content-card-wrapper"},at={__name:"index",setup(S){const r=ie(),v=H(),l=k("basic"),d=k({email:"",level:"",storage:0,created_at:""}),s=k({server:"openai",api_url:"https://api.openai.com",api_key:"",model:"gpt-3.5-turbo",backup_model:"",langs:["中文","英语"],type:["trans_text","trans_text_only","trans_text_only_new"],prompt:"你是一个文档翻译助手，请将以下文本、单词或短语直接翻译成{target_lang}，不返回原文本。如果文本中包含{target_lang}文本、特殊名词（比如邮箱、品牌名、单位名词如mm、px、℃等）、无法翻译等特殊情况，请直接返回原文而无需解释原因。遇到无法翻译的文本直接返回原内容。保留多余空格。",threads:10,comparison_id:"",prompt_id:"",doc2x_flag:"N",doc2x_secret_key:"",scanned:!1,origin_lang:""});N(()=>{d.value=r.userInfo});const g=u=>{l.value=u},a=u=>{console.log("模拟更新用户信息:",u),d.value={...d.value,...u}},p=()=>{v.push("/reset")},I=u=>{console.log("保存翻译设置:",u),localStorage.setItem("api_url",u.api_url),localStorage.setItem("api_key",u.api_key),localStorage.setItem("model",u.model),localStorage.setItem("backup_model",u.backup_model),localStorage.setItem("langs",JSON.stringify(u.langs)),localStorage.setItem("type",JSON.stringify(u.type)),localStorage.setItem("prompt",u.prompt),localStorage.setItem("threads",u.threads),localStorage.setItem("comparison_id",u.comparison_id),localStorage.setItem("prompt_id",u.prompt_id),localStorage.setItem("doc2x_flag",u.doc2x_flag),localStorage.setItem("doc2x_secret_key",u.doc2x_secret_key),s.value=u};return(u,m)=>{const i=o("el-icon"),c=o("el-menu-item"),b=o("el-menu"),_=o("el-tab-pane"),$=o("el-tabs");o("el-avatar"),o("el-tag");const P=o("el-card");return y(),w("div",Ze,[n("div",et,[n("div",tt,[e(b,{class:"side-nav","default-active":l.value,onSelect:g},{default:t(()=>[e(c,{index:"basic"},{title:t(()=>[e(i,null,{default:t(()=>[e(x(E))]),_:1}),m[1]||(m[1]=n("span",null,"基本信息",-1))]),_:1}),e(c,{index:"security"},{title:t(()=>[e(i,null,{default:t(()=>[e(x(J))]),_:1}),m[2]||(m[2]=n("span",null,"账号安全",-1))]),_:1}),e(c,{index:"translation"},{title:t(()=>[e(i,null,{default:t(()=>[e(x(G))]),_:1}),m[3]||(m[3]=n("span",null,"翻译设置",-1))]),_:1})]),_:1},8,["default-active"]),n("div",lt,[e($,{modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=D=>l.value=D),class:"mobile-tabs"},{default:t(()=>[e(_,{name:"basic"},{label:t(()=>[n("span",null,[e(i,null,{default:t(()=>[e(x(E))]),_:1}),m[4]||(m[4]=f(" 基本信息"))])]),_:1}),e(_,{name:"security"},{label:t(()=>[n("span",null,[e(i,null,{default:t(()=>[e(x(J))]),_:1}),m[5]||(m[5]=f(" 账号安全"))])]),_:1}),e(_,{name:"translation"},{label:t(()=>[n("span",null,[e(i,null,{default:t(()=>[e(x(G))]),_:1}),m[6]||(m[6]=f(" 翻译设置"))])]),_:1})]),_:1},8,["modelValue"]),T("",!0),e(Xe,{userInfo:d.value},null,8,["userInfo"]),e(P,{class:"content-card",shadow:"never"},{default:t(()=>[Y(e($e,{userInfo:d.value,onUpdateInfo:a},null,8,["userInfo"]),[[j,l.value==="basic"]]),Y(e(Ue,{email:d.value.email,onChangePassword:p},null,8,["email"]),[[j,l.value==="security"]]),Y(e(Oe,{settings:s.value,onSaveSettings:I},null,8,["settings"]),[[j,l.value==="translation"]])]),_:1})])])]),e(ue)])}}},st=F(at,[["__scopeId","data-v-a44d4357"]]);export{st as default};
