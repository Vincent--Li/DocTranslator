import{g as B,s as C}from"./index-Bse37gsK.js";import{E as m}from"./element-C0HbadzC.js";import{l as D,r as _,d as E,ah as n,ap as M,m as s,p as c,P as S,M as v,O as r,U as o,F as k,a7 as V,S as I}from"./vue-DSQ7aDT9.js";import{_ as O}from"./index-fsSxRMjm.js";import"./vxe-D9jD_6gD.js";const P={class:"app-container"},N=D({name:"接口配置",__name:"api",setup(z){const f=_(!1),e=_({api_url:"",api_key:"",models:"",default_model:"",default_backup:""}),i=_([]),b=_(null),y={api_url:[{required:!0,message:"请填写接口配置",trigger:"blur"}],api_key:[{required:!0,message:"请填写API秘钥",trigger:"blur"}],models:[{required:!0,message:"请填写模型配置",trigger:"blur"}]};E(async()=>{f.value=!0,await B().then(u=>{if(u.data){e.value=u.data;const a=u.data.models.split(",");i.value=a.filter(d=>d!="")}}),f.value=!1});function x(){if(!e.value.models)return;const u=e.value.models.split(",");i.value=u.filter(a=>a!=""),u.indexOf(e.value.default_model)==-1&&(e.value.default_model=""),u.indexOf(e.value.default_backup)==-1&&(e.value.default_backup="")}function h(u){e.value,u==null||u.validate((a,d)=>{if(a)C({api_url:e.value.api_url,api_key:e.value.api_key,models:e.value.models,default_model:e.value.default_model,default_backup:e.value.default_backup}).then(t=>{t.code==200?m.success("保存成功"):m.error(t.message)}).catch(t=>{m.error(t)});else for(const t in d){d[t].forEach(p=>{m({message:p.message,type:"error"})});break}})}return(u,a)=>{const d=n("el-input"),t=n("el-form-item"),p=n("el-option"),g=n("el-select"),q=n("el-button"),w=n("el-form"),U=n("el-card"),A=M("loading");return s(),c("div",P,[S((s(),v(U,{shadow:"never","element-loading-text":"加载中..."},{default:r(()=>[o(w,{class:"settingForm",ref_key:"settingForm",ref:b,model:e.value,"label-position":"top",rules:y},{default:r(()=>[o(t,{label:"接口配置",prop:"api_url",required:""},{default:r(()=>[o(d,{modelValue:e.value.api_url,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.api_url=l),placeholder:"https://api.openai.com"},null,8,["modelValue"])]),_:1}),o(t,{label:"API秘钥",prop:"api_key",required:""},{default:r(()=>[o(d,{modelValue:e.value.api_key,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.api_key=l),placeholder:"sk-******"},null,8,["modelValue"])]),_:1}),o(t,{label:"模型配置",prop:"models",required:""},{default:r(()=>[o(d,{type:"textarea",resize:"none",rows:3,modelValue:e.value.models,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.models=l),onBlur:x,placeholder:"请至少输入1个模型，多个模型用,隔开"},null,8,["modelValue"])]),_:1}),o(t,{label:"默认模型"},{default:r(()=>[o(g,{modelValue:e.value.default_model,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.default_model=l),placeholder:"未选择默认模型将采用配置中的第1个",clearable:""},{default:r(()=>[(s(!0),c(k,null,V(i.value,l=>(s(),v(p,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(t,{label:"默认备用模型"},{default:r(()=>[o(g,{modelValue:e.value.default_backup,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.default_backup=l),placeholder:"未选择默认备用模型将采用配置中的第1个",clearable:""},{default:r(()=>[(s(!0),c(k,null,V(i.value,l=>(s(),v(p,{key:l,disabled:e.value.default_model==l,label:l,value:l},null,8,["disabled","label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(t,{class:"setting-btns"},{default:r(()=>[o(q,{style:{width:"88px"},type:"primary",onClick:a[5]||(a[5]=l=>h(b.value))},{default:r(()=>[I("保存")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["element-loading-text"])),[[A,f.value]])])}}}),G=O(N,[["__scopeId","data-v-f91cd16c"]]);export{G as default};
